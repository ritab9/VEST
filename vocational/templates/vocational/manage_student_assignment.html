{%  extends 'base.html' %}
  {% load static %}
  {% load crispy_forms_tags %}

  {% block title %} Departments {% endblock title %}


{% block content %}

    <p class="mt-3">{{ quarter.school_year }} {{ quarter }} </p>

<form method = "POST">
	{% csrf_token %}

    <div class="row ml-3">
        <input class = "btn btn-sm btn-ISEIblue3" type= "submit" name="save" value = "Save" style="float: right">
    </div>

    <table class="table" style="width: auto">
        <thead>
            <tr>
                <th>Department</th>
                <th>Student</th>
            </tr>
        </thead>
        <tbody>
            {{ student_formset.management_data }}
            {{ student_formset.management_form }}
            {% for form in student_formset %}
                {{ form.errors }}
                {{ form.non_field_errors }}
                <tr>
                    <td>{{ form.department }}
                    {{ form.DELETE|as_crispy_field }}
                    </td>
                    <td>
                        <ul style="-webkit-column-count: 10; -moz-column-count: 10; column-count: 10; list-style-type:none">
                        {% for s in form.student %}
                            <li> {{ s }}
                                <a href="{% url 'student_vocational_info' s.data.value %}"
                                   target="popup" class="mypopup" >
                                    <i class="fa-solid fa-circle-info"></i></a>

                            </li>
                         {% endfor %}
                        </ul>
                    </td>
                </tr>
                {% for hidden in form.hidden_fields %}
                    {{ hidden }}
                {% endfor %}
            {% endfor %}
        </tbody>
    </table>
        <input class = "btn btn-sm btn-ISEIblue3" type= "submit" name="add" value = "Save and add more">
    </div>
</form>

<script>
    $("a.mypopup").on("click", function() {
        var ppp = $(this).prop('href');
        console.log(ppp);
        window.open(ppp, "popup", "toolbar=no,scrollbars=yes, resizable=yes,width=600,height=600");

});

</script>

{% endblock %}