{%  extends 'base.html' %}
    {% load static %}
    {% load crispy_forms_tags %}

  {% block title %} Add Student {% endblock title %}



{% block content %}
    <div id="id_school_abbreviation" style=" display: none"> {{ school.abbreviation }} </div>
    <div id="id_school_id" style=" display: none"> {{ school.id }} </div>

    {% if existing_user %}
        <p>This username already exists in the system. Is this a new user, or are you trying to add:</p>

    {% else %}


<div class="card card-body mt-2 padding">
<!-- registering instructor -->
    <form method="POST">
        {% csrf_token %}
        <div class="row">
            <div class="col-sm-auto">
                {{ form_user.first_name|as_crispy_field }}
                {{ form_user.last_name|as_crispy_field  }}
                {{ form_user.email|as_crispy_field }}
                {{ form_student.birthday|as_crispy_field }}
                {{ form_student.graduation_year|as_crispy_field }}
                <br>
            </div>

            <!--
            <div class="col-sm-auto">
                 { { form_student.parent|as_crispy_field }}
            </div> -->

            <div class="col-sm-auto">
                Default Username: <p>{{ school.abbreviation }}_<input type="text" id="id_default_username" name="default_username" label = "Default Username"></p>
                </p>
                <!-- { { form_user.username|as_crispy_field }}
                <div class="spanred">Username:</div> <input type="text" name="username" maxlength="150" autofocus="" class="textinput textInput" required="" id="id_username">
                <p id="id_username_info" class="spanred"></p> -->
                <div style="display: none">
                    {{ form_user.username|as_crispy_field }}</div>
                {{ form_user.password1|as_crispy_field }}
                {{ form_user.password2|as_crispy_field }}
                <p id="id_password_info" class="spanred"></p>
            </div>
        </div>
        <input class="btn btn-ISEIblue3" type="submit" value ="Register"/>
    </form>
</div>

    {% endif %}

<script>

    window.onload = function() {
      /* $('id_password_info').style.display = none; */
    };

    $('#id_last_name').focusout (function() {
        var first_name = $('#id_first_name').val();
        var last_name = $('#id_last_name').val();
        var s_a = $.trim($('#id_school_abbreviation').text());
        var s_id = $('#id_school_id').text();

        $('#id_default_username').val(first_name + last_name);
        $('#id_username').val(s_a +"_"+first_name + last_name);

        /* document.getElementById('id_username_info').innerHTML = "Default Username: " +  first_name + last_name ; */
        $('#id_password1').val("VEST" + "_" + s_a + "_" + s_id);
        $('#id_password2').val("VEST" + "_" + s_a + "_" + s_id);
        document.getElementById('id_password_info').innerHTML = "Default Password: VEST" + "_" + s_a + "_" + s_id ;
    });

    $('#id_default_username').focusout (function(){
        var s_a = $.trim($('#id_school_abbreviation').text());
        var p_u = $('#id_default_username').val();
        $('#id_username').val(s_a+"_"+p_u).trim();
    });


</script>

{% endblock content %}
